<!DOCTYPE html>

<!-- 
  Property of CEV Multimedia

  Experience created by Melody Rowell: https://github.com/merowell

  Based on the AR.js library and examples created by Jerome Etienne: https://github.com/jeromeetienne/AR.js/
-->

<!-- A-FRAME -->
<script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script> 
<!-- include aframe-ar.js -->
<script src="build/aframe-ar.js"></script> 
<script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script> 
<script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script> 
<script src="https://unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> 

<!-- Latest compiled and minified CSS -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- vidhandler component -->
<script>
AFRAME.registerComponent('vidhandler', {
    schema: {
      target: {type: 'string'}
    },
    init: function() {
        this.videoNodes = document.querySelectorAll(this.data.target)
    },
    tick: function() {
        if (this.el.object3D.visible == true) {
            if (!this.toggle) {
                this.toggle = true;
                for (let i = 0; i < this.videoNodes.length; i++) {
                    this.videoNodes[i].play();
                } 
            }
        } else {
            if (this.toggle) {
              for (let i = 0; i < this.videoNodes.length; i++) {
                this.videoNodes[i].pause();
              }
              this.toggle = false;
            }
        }
    }
});
</script>

<script>
      AFRAME.registerComponent("depth-correction", {
        init: function() {
          this.el.addEventListener("model-loaded", e => {
            let model = this.el.getObject3D("mesh");
            model.traverse(node => {
              if (node.isMesh) {
                node.material.depthWrite = !node.material.transparent;
              }
            });
          });
        }
      });
    </script>





<body>
<a-scene embedded arjs >

<!-- Lighting -->
<a-entity light="type: ambient; color: #BBB"></a-entity>
<a-entity light="type: directional; color: #FFF; intensity: 1" position="-0.5 1 1"></a-entity>

<!-- Narcotics -->
<a-marker type='pattern' url='https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/markers/patt/pattern-narcotics-1%20(1).patt'>   

    <!-- add .obj model-->
    <a-entity 
    obj-model= 'obj: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/pills.obj); 
    mtl: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/pills.mtl)' scale="0.25 0.25 0.25" position='0 0 0' rotation='0 0 0'>
    </a-entity>

    <a-entity 
    obj-model= 'obj: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/syringe.obj); 
    mtl: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/syringe.mtl)' scale=".2 .2 .2" position='-.4 -.1 -.3' rotation='0 55 0'>
    </a-entity>

    <a-entity 
    obj-model= 'obj: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/syringe-push.obj); 
    mtl: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/narcotics/syringe-push.mtl)' scale=".2 .2 .2" position='-.4 -.1 -.3' rotation='0 55 0'>
    </a-entity>  

</a-marker>




<!-- ballistics -->
<a-marker type='pattern' url='https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/markers/patt/pattern-ballistics-1.patt'>

    <!-- add .obj model-->
    <a-entity 
    obj-model= 'obj: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/ballistics/ballistics-1.obj); 
    mtl: url(https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/ballistics/ballistics-1.mtl)' scale="0.5 0.5 0.5" position='.5 -.3 0' rotation='0 0 0'>
    </a-entity>
        
</a-marker>




<!-- biological marker -->
<a-marker type='pattern' url='https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/markers/patt/pattern-biological-1.patt'>

<!-- add .gltf model-->
    <a-entity gltf-model="https://raw.githubusercontent.com/merowell/Evidence-Collection-Procedures/master/assets/models/biological/biological.gltf" scale=".5 .5 .5" position='-1 0 0' depth-correction> 
    </a-entity>

</a-marker>













<!-- add a simple camera -->
<a-entity camera></a-entity>

</a-scene>

</body>


<!-- fixes glitchy models - NECESSARY! -->
<script>
    // Workaround for an AR.js bug (https://github.com/jeromeetienne/AR.js/issues/410)
    const sceneEl = document.querySelector('a-scene');
    sceneEl.addEventListener('loaded', () => {
    sceneEl.camera = new THREE.PerspectiveCamera();
    });
</script>



<style>
     .footer {
     position: fixed;
     left: 0;
     bottom: 0;
     width: 100%;
     color: white;
     }
     .onebleft{
     padding: 5px 5px 5px 5px;
     margin: 5px 15px 5px 5px ;
     float: left;
     z-index: 900000000000;
     }
     .onebright{
     padding: 5px 5px 5px 5px;
     margin: 5px 15px 5px 5px ;
     float: right;
     z-index: 900000000000;
     }
     .imgon{
     width: 55px;
     height: 55px;
     background-color:white;
     padding: 3px 2px 2px 2px !important;
     }
     .imgss{
     width: 50px !important;
     height:50px !important;
     } 
     .imgname{
     font-size: 10px;
     }
     .header {
     position: fixed;
     left: 0;
     top: 0;
     width: 100%;
     color: white;
     }
     .oneleft{
     padding: 5px 5px 5px 5px;
     margin: 5px 15px 5px 5px ;
     float: left;
     z-index: 900000000000;
     }
     body{
     margin:0px;
     overflow: hidden;
     }
     .resets{
     background-color: rgba(51, 51, 51, 0.529);
     color: #fff;
     text-align: center;
     border-radius: 2px;
     height: 50px;
     padding: 10px 10px 10px 10px;
     position: fixed;
     top: 10px;
     text-align: center;
     z-index: 9000000000;
     bottom: 10px;
     }
     .btnskips{
     background: rgba(0, 0, 0, 0.433);
     color: white !important;
     }
     .btnskips:hover{
     background: rgb(197, 197, 197);
     }
     #arjsDebugUIContainer{
     display: none;
     }
     .a-enter-vr-button{
     display: none !important;
     }
</style>

</html>